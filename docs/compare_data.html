<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Githubz0r" />


<title>first_steps</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">semb</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/githubz0r/semb">
    <span class="fa fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">first_steps</h1>
<h4 class="author">Githubz0r</h4>
<h4 class="date">2/13/2020</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2020-02-28
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>semb/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.6.0). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20200213code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20200213)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20200213code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20200213)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomgithubz0rsembtreefbfb7666f83298ad02c6a0bc4edceadbad69ef8dtargetblankfbfb766a"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/githubz0r/semb/tree/fbfb7666f83298ad02c6a0bc4edceadbad69ef8d" target="_blank">fbfb766</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomgithubz0rsembtreefbfb7666f83298ad02c6a0bc4edceadbad69ef8dtargetblankfbfb766a" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility. The version displayed above was the version of the Git repository at the time these results were generated. <br><br> Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    analysis/figure/

Untracked files:
    Untracked:  analysis/first_steps.Rmd
    Untracked:  code/data_entry_pancrea_holes.R
    Untracked:  code/for_wflow_cmds.R

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the R Markdown and HTML files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view them.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/githubz0r/semb/blob/fbfb7666f83298ad02c6a0bc4edceadbad69ef8d/analysis/compare_data.Rmd" target="_blank">fbfb766</a>
</td>
<td>
githubz0r
</td>
<td>
2020-02-28
</td>
<td>
upload markdown of lm analysis and comparison of silja pancrea and my pancrea
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="preparation" class="section level2">
<h2>preparation</h2>
<p>Load data and packages. We’ll just both the data set with numCon/numEnds annotated by Silja and the one annotated by me.</p>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>── Attaching packages ────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>✔ ggplot2 3.2.1     ✔ purrr   0.3.3
✔ tibble  2.1.3     ✔ dplyr   0.8.3
✔ tidyr   1.0.0     ✔ stringr 1.4.0
✔ readr   1.3.1     ✔ forcats 0.4.0</code></pre>
<pre><code>── Conflicts ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(irlba)</code></pre>
<pre><code>Loading required package: Matrix</code></pre>
<pre><code>
Attaching package: &#39;Matrix&#39;</code></pre>
<pre><code>The following objects are masked from &#39;package:tidyr&#39;:

    expand, pack, unpack</code></pre>
<pre class="r"><code>library(magrittr)</code></pre>
<pre><code>
Attaching package: &#39;magrittr&#39;</code></pre>
<pre><code>The following object is masked from &#39;package:purrr&#39;:

    set_names</code></pre>
<pre><code>The following object is masked from &#39;package:tidyr&#39;:

    extract</code></pre>
<pre class="r"><code>library(cowplot)</code></pre>
<pre><code>
********************************************************</code></pre>
<pre><code>Note: As of version 1.0.0, cowplot does not change the</code></pre>
<pre><code>  default ggplot2 theme anymore. To recover the previous</code></pre>
<pre><code>  behavior, execute:
  theme_set(theme_cowplot())</code></pre>
<pre><code>********************************************************</code></pre>
<pre class="r"><code>pancrea_holes_all &lt;- read.csv(&#39;/Users/Deathvoodoo/Documents/semb_int/TableTilLars.csv&#39;)
pancrea_holes_altered &lt;- read.csv(&#39;/Users/Deathvoodoo/Documents/semb_int/table_2_full.csv&#39;)
pancrea_holes_1 &lt;- pancrea_holes_all[names(pancrea_holes_all)!=&#39;hole_area_raw&#39;] %&gt;% na.omit
pancrea_holes_2 &lt;- pancrea_holes_altered[names(pancrea_holes_altered)!=&#39;hole_area_raw&#39;] %&gt;% na.omit</code></pre>
</div>
<div id="analysis" class="section level2">
<h2>analysis</h2>
<p>First some plots We just quickly visualize dAdt as a function of each predictor.</p>
<pre class="r"><code>predictors_1 &lt;- c(&quot;numCon&quot;, &quot;numEnds&quot;, &quot;period&quot;, &quot;hole_area_smooth&quot;, &quot;eccentricity&quot;, &quot;solidity&quot;)
predictors_2 &lt;- c(&quot;numCon&quot;, &quot;numEnds&quot;, &quot;period&quot;, &quot;hole_area_smooth&quot;, &quot;eccentricity&quot;, &quot;solidity&quot;)
#predictors_3 &lt;- c(&quot;numCon&quot;, &quot;numEnds&quot;, &quot;period&quot;, &quot;hole_area_smooth&quot;, &quot;eccentricity&quot;, &quot;solidity&quot;, &quot;time_point&quot;)
pancrea_1_norm &lt;- pancrea_holes_1 %&gt;% lapply(function(x){if (x[1] %&gt;% is.numeric()) {x/sd(x)} else{x}}) %&gt;% as.data.frame()
pancrea_2_norm &lt;- pancrea_holes_2 %&gt;% lapply(function(x){if (x[1] %&gt;% is.numeric()) {x/sd(x)} else{x}}) %&gt;% as.data.frame()

pancrea_1_norm_long &lt;- pancrea_1_norm %&gt;% pivot_longer(cols=predictors_1, names_to=&#39;predictors&#39;)
pancrea_2_norm_long &lt;- pancrea_2_norm %&gt;% pivot_longer(cols=predictors_2, names_to=&#39;predictors&#39;)

pancrea_1_norm_long %&gt;% ggplot(aes(x=value, y=dAdt, col=predictors))+geom_point(size=0.2, alpha=0.5)</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-2-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>pancrea_2_norm_long %&gt;% ggplot(aes(x=value, y=dAdt, col=predictors))+geom_point(size=0.2, alpha=0.5)</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-2-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>Now we do some PCA plots, with and without scaling the variances. We color both by hole and dataset to get an overview of how our points are lying together.</p>
<pre class="r"><code>DoIrlbaPCA &lt;- function(data.mat, predictor.names, make.plots=T){
  panc.pca.unscaled &lt;- irlba::prcomp_irlba(data.mat[predictor.names], n=2)
  panc.pca.scaled &lt;- irlba::prcomp_irlba(data.mat[predictor.names], n=2, scale.=T)
  if(make.plots){
    panc.pca.unscaled.df &lt;- setNames(panc.pca.unscaled$x %&gt;% as.data.frame, c(&#39;PC1&#39;, &#39;PC2&#39;)) %&gt;% bind_cols(data.mat[setdiff(names(data.mat), predictor.names)])
    panc.pca.scaled.df &lt;- setNames(panc.pca.scaled$x %&gt;% as.data.frame, c(&#39;PC1&#39;, &#39;PC2&#39;)) %&gt;% bind_cols(data.mat[setdiff(names(data.mat), predictor.names)])
    phole.unscaled &lt;- panc.pca.unscaled.df %&gt;% ggplot(aes(x=PC1, y=PC2, col=as.factor(hole_num_rep), shape=data_set_name))+geom_point(alpha=0.5)+guides(col = guide_legend(ncol = 3))
    phole.scaled &lt;- panc.pca.scaled.df %&gt;% ggplot(aes(x=PC1, y=PC2, col=as.factor(hole_num_rep), shape=data_set_name))+geom_point(alpha=0.5)+guides(col = guide_legend(ncol = 3))
    pdataset.scaled &lt;- panc.pca.scaled.df %&gt;% ggplot(aes(x=PC1, y=PC2, col=data_set_name))+geom_point(alpha=0.5)+guides(col = guide_legend(ncol = 3))
  }
  return(list(panc.pca.unscaled=panc.pca.unscaled, panc.pca.scaled=panc.pca.scaled, phole.unscaled=phole.unscaled, phole.scaled=phole.scaled, 
              pdataset.scaled=pdataset.scaled))
}

pancrea_1_pca &lt;- DoIrlbaPCA(pancrea_holes_1, predictors_1)
pancrea_2_pca &lt;- DoIrlbaPCA(pancrea_holes_2, predictors_2)

pancrea_1_pca$phole.scaled</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>pancrea_1_pca$pdataset.scaled</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-3-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>pancrea_2_pca$phole.scaled</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-3-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>pancrea_2_pca$pdataset.scaled</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-3-4.png" width="672" style="display: block; margin: auto;" /> Check weights of the features in the rotation matrices</p>
<pre class="r"><code>predictors_2 %&gt;% setNames(1:length(predictors_2), .)</code></pre>
<pre><code>          numCon          numEnds           period hole_area_smooth 
               1                2                3                4 
    eccentricity         solidity 
               5                6 </code></pre>
<pre class="r"><code>pancrea_1_pca$panc.pca.scaled$rotation</code></pre>
<pre><code>            PC1         PC2
[1,] -0.4144738 -0.49053188
[2,]  0.1312448 -0.64677488
[3,] -0.3038964 -0.02637844
[4,] -0.5044041 -0.27287369
[5,] -0.3329065  0.48612903
[6,]  0.5944602 -0.17199831</code></pre>
<pre class="r"><code>pancrea_2_pca$panc.pca.scaled$rotation</code></pre>
<pre><code>            PC1        PC2
[1,]  0.5228088 -0.2554301
[2,]  0.2345789 -0.6083004
[3,]  0.2065639  0.3559548
[4,]  0.5514703 -0.1930589
[5,]  0.2609432  0.5384805
[6,] -0.5067190 -0.3328503</code></pre>
<p>We check distribution of dAdt. Of course, for fitting a linear model (with gaussian noise) we assume that the data is normally distributed, so it better be.</p>
<pre class="r"><code>qplot(pancrea_holes_1$dAdt)</code></pre>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-5-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Check correlation between variables, both as scatter plot and heat map.</p>
<pre class="r"><code>MakeCorrelationPlots &lt;- function(data.matrix){
  corr.mat &lt;- cor(data.matrix)
  corr.values &lt;- corr.mat; corr.values[upper.tri(corr.values, diag=T)] &lt;- NA
  corr.values &lt;- corr.values %&gt;% reshape2::melt() %&gt;% na.omit %&gt;% transmute(which_factors=paste0(Var1,&quot;+&quot;, Var2), correlation=value)
  pcor.scatter &lt;- corr.values %&gt;% ggplot(aes(x=which_factors, y=correlation))+geom_point()+theme(axis.text.x = element_text(angle = 90, hjust = 1))
  pcor.heat &lt;- corr.mat %&gt;% reshape2::melt() %&gt;% ggplot(aes(x=Var1, y=Var2, fill=value))+geom_tile()+scale_fill_continuous(high = &quot;#132B43&quot;, low = &quot;#56B1F7&quot;)+
    theme(axis.text.x = element_text(angle = 90, hjust = 1))
  return(list(pcor.scatter=pcor.scatter, pcor.heat=pcor.heat))
}
corplot_1 &lt;- MakeCorrelationPlots(pancrea_holes_1[c(&#39;dAdt&#39;, predictors_1)])
corplot_2 &lt;- MakeCorrelationPlots(pancrea_holes_2[c(&#39;dAdt&#39;, predictors_2)])

corplot_1$pcor.scatter</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>corplot_1$pcor.heat</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-6-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>corplot_2$pcor.scatter</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-6-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>corplot_2$pcor.heat</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-6-4.png" width="672" style="display: block; margin: auto;" /></p>
<p>Now we start fitting some models. We first try all the variables. Note that we are omitting dEdt because Silja said it’s not important and also numEnds_over_numCon since it’s very highly correlation with numEnds</p>
<pre class="r"><code>cor(pancrea_holes_1$numEnds, pancrea_holes_1$numEnds_over_numCon)</code></pre>
<pre><code>[1] 0.9663755</code></pre>
<p>The third model will be including the time, i.e. the time in the video annotated by me.</p>
<pre class="r"><code>linmodel_1 &lt;- lm(dAdt~numCon + numEnds + period + hole_area_smooth + eccentricity + solidity, data = pancrea_holes_1)
linmodel_2 &lt;- lm(dAdt~numCon + numEnds + period + hole_area_smooth + eccentricity + solidity, data = pancrea_holes_2)
linmodel_time &lt;- lm(dAdt~numCon + numEnds + period + hole_area_smooth + eccentricity + solidity + time_point, data = pancrea_holes_2)</code></pre>
<p>Diagnostic plots of the models. Things definitely do not look iid/evenly distribution noise/homoskedastic</p>
<pre class="r"><code>plot(linmodel_1)</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;" /><img src="figure/compare_data.Rmd/unnamed-chunk-9-2.png" width="672" style="display: block; margin: auto;" /><img src="figure/compare_data.Rmd/unnamed-chunk-9-3.png" width="672" style="display: block; margin: auto;" /><img src="figure/compare_data.Rmd/unnamed-chunk-9-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(linmodel_2)</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-9-5.png" width="672" style="display: block; margin: auto;" /><img src="figure/compare_data.Rmd/unnamed-chunk-9-6.png" width="672" style="display: block; margin: auto;" /><img src="figure/compare_data.Rmd/unnamed-chunk-9-7.png" width="672" style="display: block; margin: auto;" /><img src="figure/compare_data.Rmd/unnamed-chunk-9-8.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(linmodel_time)</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-9-9.png" width="672" style="display: block; margin: auto;" /><img src="figure/compare_data.Rmd/unnamed-chunk-9-10.png" width="672" style="display: block; margin: auto;" /><img src="figure/compare_data.Rmd/unnamed-chunk-9-11.png" width="672" style="display: block; margin: auto;" /><img src="figure/compare_data.Rmd/unnamed-chunk-9-12.png" width="672" style="display: block; margin: auto;" /></p>
<p>We print some summaries of the models. This gives some various statistical info, such as e.g. weight estimates, p values when doing some kind of t-test of the weights (with null hypothesis that they are equal to zero). This gives similar values to doing a likelihood ratio test where the nested model lacks that coefficient. Note that the models are all complete trash, judging by the R^2 values.</p>
<pre class="r"><code>summary(linmodel_1)</code></pre>
<pre><code>
Call:
lm(formula = dAdt ~ numCon + numEnds + period + hole_area_smooth + 
    eccentricity + solidity, data = pancrea_holes_1)

Residuals:
     Min       1Q   Median       3Q      Max 
-248.653  -18.581    2.319   19.959  182.195 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      -6.555e+01  2.537e+01  -2.584 0.009820 ** 
numCon           -6.016e+00  7.448e-01  -8.077 9.48e-16 ***
numEnds          -6.282e+00  8.174e-01  -7.685 2.04e-14 ***
period            2.127e-01  1.750e-01   1.215 0.224327    
hole_area_smooth  4.393e-03  4.287e-04  10.247  &lt; 2e-16 ***
eccentricity     -2.789e+01  8.026e+00  -3.475 0.000517 ***
solidity          9.887e+01  2.330e+01   4.244 2.26e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 40.51 on 3063 degrees of freedom
Multiple R-squared:  0.07249,   Adjusted R-squared:  0.07067 
F-statistic:  39.9 on 6 and 3063 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>summary(linmodel_2)</code></pre>
<pre><code>
Call:
lm(formula = dAdt ~ numCon + numEnds + period + hole_area_smooth + 
    eccentricity + solidity, data = pancrea_holes_2)

Residuals:
     Min       1Q   Median       3Q      Max 
-251.242  -20.044    0.096   21.088  186.804 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      -4.368e+01  2.592e+01  -1.685  0.09201 .  
numCon           -2.650e+00  8.188e-01  -3.237  0.00122 ** 
numEnds           1.523e+00  7.032e-01   2.166  0.03041 *  
period           -5.143e-02  1.762e-01  -0.292  0.77033    
hole_area_smooth  3.141e-03  5.047e-04   6.223 5.55e-10 ***
eccentricity     -1.873e+01  8.219e+00  -2.279  0.02276 *  
solidity          5.449e+01  2.391e+01   2.279  0.02275 *  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 41.53 on 3063 degrees of freedom
Multiple R-squared:  0.02545,   Adjusted R-squared:  0.02355 
F-statistic: 13.33 on 6 and 3063 DF,  p-value: 5.671e-15</code></pre>
<pre class="r"><code>summary(linmodel_time)</code></pre>
<pre><code>
Call:
lm(formula = dAdt ~ numCon + numEnds + period + hole_area_smooth + 
    eccentricity + solidity + time_point, data = pancrea_holes_2)

Residuals:
     Min       1Q   Median       3Q      Max 
-251.898  -19.883    0.044   21.039  186.622 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      -4.396e+01  2.592e+01  -1.696  0.09002 .  
numCon           -2.357e+00  8.871e-01  -2.657  0.00793 ** 
numEnds           1.572e+00  7.056e-01   2.228  0.02593 *  
period           -3.726e-02  1.769e-01  -0.211  0.83323    
hole_area_smooth  3.041e-03  5.178e-04   5.873 4.74e-09 ***
eccentricity     -1.799e+01  8.264e+00  -2.177  0.02955 *  
solidity          5.372e+01  2.393e+01   2.245  0.02485 *  
time_point       -1.194e-02  1.389e-02  -0.860  0.39011    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 41.53 on 3062 degrees of freedom
Multiple R-squared:  0.02569,   Adjusted R-squared:  0.02346 
F-statistic: 11.53 on 7 and 3062 DF,  p-value: 1.546e-14</code></pre>
<p>Just testing linmodel_time vs the nested model linmodel_2 (and we can also do some aic). We see that time basically sucks.</p>
<pre class="r"><code>anova(linmodel_2, linmodel_time)</code></pre>
<pre><code>Analysis of Variance Table

Model 1: dAdt ~ numCon + numEnds + period + hole_area_smooth + eccentricity + 
    solidity
Model 2: dAdt ~ numCon + numEnds + period + hole_area_smooth + eccentricity + 
    solidity + time_point
  Res.Df     RSS Df Sum of Sq      F Pr(&gt;F)
1   3063 5282761                           
2   3062 5281486  1    1274.3 0.7388 0.3901</code></pre>
<pre class="r"><code>AIC(linmodel_2) - AIC(linmodel_time) # should be positive if linmodel 3 is better</code></pre>
<pre><code>[1] -1.259347</code></pre>
<p>Is our model even better than just random shit? We can make some random data frames and see.</p>
<pre class="r"><code>RandomizeDataframe &lt;- function(df){
  df.random &lt;- df %&gt;% lapply(function(x){sample(x)}) %&gt;% as.data.frame
  return(df.random)
}

random_pancreas &lt;- replicate(100, RandomizeDataframe(pancrea_holes_1), simplify = FALSE)</code></pre>
<p>Let’s test the random data frames</p>
<pre class="r"><code>random_results &lt;- random_pancreas %&gt;% lapply(function(x){
  linmodel.random &lt;- lm(dAdt~numCon + numEnds + period + hole_area_smooth + eccentricity + solidity, data = x)
  random.lm.summary &lt;- summary(linmodel.random)
  residual.standard.error &lt;- random.lm.summary$sigma
  r.squared &lt;- random.lm.summary$r.squared
  r.squared.adjusted &lt;- random.lm.summary$adj.r.squared
  sum.squared.resids &lt;- sum(residuals(linmodel.random)^2)
  return(c(residual.standard.error=residual.standard.error, r.squared=r.squared, 
           r.squared.adjusted=r.squared.adjusted, sum.squared.resids=sum.squared.resids))
})

output_values_random &lt;-random_results[[1]] %&gt;% names %&gt;% lapply(function(x){
  value.for.all.res &lt;- random_results %&gt;% lapply(function(result.vector){result.vector[[x]] %&gt;% unname})
  return(value.for.all.res)
}) %&gt;% lapply(unlist); output_values_random %&lt;&gt;% setNames(random_results[[1]] %&gt;% names)

output_values_random$residual.standard.error %&gt;% qplot</code></pre>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>output_values_random$r.squared %&gt;% qplot</code></pre>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-13-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>output_values_random$r.squared.adjusted %&gt;% qplot</code></pre>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-13-3.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>output_values_random$sum.squared.resids %&gt;% qplot</code></pre>
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-13-4.png" width="672" style="display: block; margin: auto;" /> We compare mean values from randomized data frames with the values for the first linear model. It’s a little bit better.</p>
<pre class="r"><code>output_values_random %&gt;% lapply(mean) %&gt;% unlist</code></pre>
<pre><code>residual.standard.error               r.squared      r.squared.adjusted 
           4.202383e+01            2.116853e-03            1.621355e-04 
     sum.squared.resids 
           5.409268e+06 </code></pre>
<pre class="r"><code>summary(linmodel_1)</code></pre>
<pre><code>
Call:
lm(formula = dAdt ~ numCon + numEnds + period + hole_area_smooth + 
    eccentricity + solidity, data = pancrea_holes_1)

Residuals:
     Min       1Q   Median       3Q      Max 
-248.653  -18.581    2.319   19.959  182.195 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      -6.555e+01  2.537e+01  -2.584 0.009820 ** 
numCon           -6.016e+00  7.448e-01  -8.077 9.48e-16 ***
numEnds          -6.282e+00  8.174e-01  -7.685 2.04e-14 ***
period            2.127e-01  1.750e-01   1.215 0.224327    
hole_area_smooth  4.393e-03  4.287e-04  10.247  &lt; 2e-16 ***
eccentricity     -2.789e+01  8.026e+00  -3.475 0.000517 ***
solidity          9.887e+01  2.330e+01   4.244 2.26e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 40.51 on 3063 degrees of freedom
Multiple R-squared:  0.07249,   Adjusted R-squared:  0.07067 
F-statistic:  39.9 on 6 and 3063 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>sum(residuals(linmodel_1)^2)</code></pre>
<pre><code>[1] 5027797</code></pre>
<p>Now we can do some stepwise linear regression with different R packages, using AIC/BIC as criteria.</p>
<pre class="r"><code>library(MASS)</code></pre>
<pre><code>
Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>The following object is masked from &#39;package:dplyr&#39;:

    select</code></pre>
<pre class="r"><code>library(leaps)</code></pre>
<p>First using MASS</p>
<pre class="r"><code>step_mass_bi &lt;- stepAIC(linmodel_1, direction=&#39;both&#39;)</code></pre>
<pre><code>Start:  AIC=22735.25
dAdt ~ numCon + numEnds + period + hole_area_smooth + eccentricity + 
    solidity

                   Df Sum of Sq     RSS   AIC
- period            1      2425 5030221 22735
&lt;none&gt;                          5027797 22735
- eccentricity      1     19826 5047623 22745
- solidity          1     29564 5057360 22751
- numEnds           1     96948 5124744 22792
- numCon            1    107075 5134871 22798
- hole_area_smooth  1    172367 5200163 22837

Step:  AIC=22734.73
dAdt ~ numCon + numEnds + hole_area_smooth + eccentricity + solidity

                   Df Sum of Sq     RSS   AIC
&lt;none&gt;                          5030221 22735
+ period            1      2425 5027797 22735
- eccentricity      1     17873 5048094 22744
- solidity          1     30451 5060672 22751
- numEnds           1     98933 5129155 22792
- numCon            1    105419 5135640 22796
- hole_area_smooth  1    174482 5204703 22837</code></pre>
<pre class="r"><code>summary(step_mass_bi)</code></pre>
<pre><code>
Call:
lm(formula = dAdt ~ numCon + numEnds + hole_area_smooth + eccentricity + 
    solidity, data = pancrea_holes_1)

Residuals:
    Min      1Q  Median      3Q     Max 
-248.81  -18.10    1.92   19.81  183.92 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      -6.441e+01  2.535e+01  -2.540  0.01112 *  
numCon           -5.805e+00  7.244e-01  -8.013 1.57e-15 ***
numEnds          -6.337e+00  8.163e-01  -7.763 1.12e-14 ***
hole_area_smooth  4.416e-03  4.284e-04  10.309  &lt; 2e-16 ***
eccentricity     -2.596e+01  7.867e+00  -3.299  0.00098 ***
solidity          1.002e+02  2.327e+01   4.307 1.71e-05 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 40.52 on 3064 degrees of freedom
Multiple R-squared:  0.07204,   Adjusted R-squared:  0.07053 
F-statistic: 47.57 on 5 and 3064 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>We can try putting in a model with second order interactions and see what happens.</p>
<pre class="r"><code>step_mass_squared_bi &lt;- stepAIC(lm(dAdt~.^2, data = pancrea_holes_1[c(&#39;dAdt&#39;, predictors_1)]), direction=&#39;both&#39;)</code></pre>
<pre><code>Start:  AIC=22280.89
dAdt ~ (numCon + numEnds + period + hole_area_smooth + eccentricity + 
    solidity)^2

                                Df Sum of Sq     RSS   AIC
- numEnds:hole_area_smooth       1       405 4294365 22279
- numEnds:solidity               1       569 4294529 22279
- period:hole_area_smooth        1      1908 4295868 22280
&lt;none&gt;                                       4293960 22281
- numEnds:period                 1      3012 4296972 22281
- numEnds:eccentricity           1      4029 4297989 22282
- numCon:period                  1     15649 4309609 22290
- period:solidity                1     16108 4310068 22290
- period:eccentricity            1     17205 4311164 22291
- numCon:eccentricity            1     18125 4312085 22292
- eccentricity:solidity          1     22362 4316321 22295
- numCon:solidity                1     63673 4357633 22324
- numCon:numEnds                 1    102497 4396456 22351
- numCon:hole_area_smooth        1    109613 4403572 22356
- hole_area_smooth:eccentricity  1    184435 4478395 22408
- hole_area_smooth:solidity      1    327369 4621328 22504

Step:  AIC=22279.18
dAdt ~ numCon + numEnds + period + hole_area_smooth + eccentricity + 
    solidity + numCon:numEnds + numCon:period + numCon:hole_area_smooth + 
    numCon:eccentricity + numCon:solidity + numEnds:period + 
    numEnds:eccentricity + numEnds:solidity + period:hole_area_smooth + 
    period:eccentricity + period:solidity + hole_area_smooth:eccentricity + 
    hole_area_smooth:solidity + eccentricity:solidity

                                Df Sum of Sq     RSS   AIC
- numEnds:solidity               1       178 4294543 22277
- period:hole_area_smooth        1      2131 4296496 22279
&lt;none&gt;                                       4294365 22279
- numEnds:period                 1      3436 4297801 22280
- numEnds:eccentricity           1      3643 4298008 22280
+ numEnds:hole_area_smooth       1       405 4293960 22281
- numCon:period                  1     15244 4309609 22288
- period:solidity                1     16700 4311065 22289
- period:eccentricity            1     17304 4311669 22290
- numCon:eccentricity            1     18882 4313247 22291
- eccentricity:solidity          1     22077 4316442 22293
- numCon:solidity                1     63271 4357636 22322
- numCon:numEnds                 1    106057 4400422 22352
- numCon:hole_area_smooth        1    114792 4409157 22358
- hole_area_smooth:eccentricity  1    184369 4478734 22406
- hole_area_smooth:solidity      1    334495 4628859 22508

Step:  AIC=22277.31
dAdt ~ numCon + numEnds + period + hole_area_smooth + eccentricity + 
    solidity + numCon:numEnds + numCon:period + numCon:hole_area_smooth + 
    numCon:eccentricity + numCon:solidity + numEnds:period + 
    numEnds:eccentricity + period:hole_area_smooth + period:eccentricity + 
    period:solidity + hole_area_smooth:eccentricity + hole_area_smooth:solidity + 
    eccentricity:solidity

                                Df Sum of Sq     RSS   AIC
- period:hole_area_smooth        1      2258 4296801 22277
&lt;none&gt;                                       4294543 22277
- numEnds:eccentricity           1      3523 4298067 22278
- numEnds:period                 1      5087 4299630 22279
+ numEnds:solidity               1       178 4294365 22279
+ numEnds:hole_area_smooth       1        14 4294529 22279
- numCon:period                  1     15158 4309701 22286
- period:solidity                1     17073 4311616 22288
- period:eccentricity            1     17716 4312259 22288
- numCon:eccentricity            1     19816 4314359 22289
- eccentricity:solidity          1     22158 4316701 22291
- numCon:solidity                1     70592 4365136 22325
- numCon:hole_area_smooth        1    115390 4409933 22357
- numCon:numEnds                 1    120313 4414856 22360
- hole_area_smooth:eccentricity  1    185186 4479729 22405
- hole_area_smooth:solidity      1    348112 4642656 22515

Step:  AIC=22276.92
dAdt ~ numCon + numEnds + period + hole_area_smooth + eccentricity + 
    solidity + numCon:numEnds + numCon:period + numCon:hole_area_smooth + 
    numCon:eccentricity + numCon:solidity + numEnds:period + 
    numEnds:eccentricity + period:eccentricity + period:solidity + 
    hole_area_smooth:eccentricity + hole_area_smooth:solidity + 
    eccentricity:solidity

                                Df Sum of Sq     RSS   AIC
&lt;none&gt;                                       4296801 22277
- numEnds:eccentricity           1      2898 4299699 22277
+ period:hole_area_smooth        1      2258 4294543 22277
- numEnds:period                 1      4599 4301400 22278
+ numEnds:solidity               1       306 4296496 22279
+ numEnds:hole_area_smooth       1        18 4296784 22279
- period:solidity                1     15117 4311918 22286
- numCon:period                  1     15498 4312299 22286
- period:eccentricity            1     15779 4312580 22286
- eccentricity:solidity          1     21183 4317984 22290
- numCon:eccentricity            1     22487 4319288 22291
- numCon:solidity                1     68903 4365704 22324
- numCon:numEnds                 1    119991 4416792 22360
- numCon:hole_area_smooth        1    146145 4442946 22378
- hole_area_smooth:eccentricity  1    183921 4480722 22404
- hole_area_smooth:solidity      1    347521 4644322 22514</code></pre>
<pre class="r"><code>summary(step_mass_squared_bi)</code></pre>
<pre><code>
Call:
lm(formula = dAdt ~ numCon + numEnds + period + hole_area_smooth + 
    eccentricity + solidity + numCon:numEnds + numCon:period + 
    numCon:hole_area_smooth + numCon:eccentricity + numCon:solidity + 
    numEnds:period + numEnds:eccentricity + period:eccentricity + 
    period:solidity + hole_area_smooth:eccentricity + hole_area_smooth:solidity + 
    eccentricity:solidity, data = pancrea_holes_1[c(&quot;dAdt&quot;, predictors_1)])

Residuals:
    Min      1Q  Median      3Q     Max 
-209.37  -18.57    2.34   18.93  175.63 

Coefficients:
                                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                    1.373e+02  2.107e+02   0.652 0.514734    
numCon                        -1.495e+02  3.063e+01  -4.882 1.10e-06 ***
numEnds                        3.383e+01  9.868e+00   3.428 0.000616 ***
period                         1.785e+01  6.351e+00   2.810 0.004989 ** 
hole_area_smooth               2.306e-01  1.363e-02  16.918  &lt; 2e-16 ***
eccentricity                  -3.109e+02  1.857e+02  -1.674 0.094143 .  
solidity                      -5.048e+02  2.140e+02  -2.359 0.018372 *  
numCon:numEnds                -1.088e+01  1.179e+00  -9.230  &lt; 2e-16 ***
numCon:period                  1.091e+00  3.289e-01   3.317 0.000920 ***
numCon:hole_area_smooth       -4.652e-03  4.566e-04 -10.187  &lt; 2e-16 ***
numCon:eccentricity           -4.019e+01  1.006e+01  -3.996 6.60e-05 ***
numCon:solidity                1.952e+02  2.791e+01   6.995 3.25e-12 ***
numEnds:period                 4.589e-01  2.539e-01   1.807 0.070844 .  
numEnds:eccentricity          -1.486e+01  1.036e+01  -1.434 0.151553    
period:eccentricity           -5.812e+00  1.736e+00  -3.347 0.000826 ***
period:solidity               -1.880e+01  5.739e+00  -3.276 0.001064 ** 
hole_area_smooth:eccentricity -6.308e-02  5.520e-03 -11.428  &lt; 2e-16 ***
hole_area_smooth:solidity     -1.796e-01  1.143e-02 -15.709  &lt; 2e-16 ***
eccentricity:solidity          7.934e+02  2.046e+02   3.878 0.000107 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 37.53 on 3051 degrees of freedom
Multiple R-squared:  0.2073,    Adjusted R-squared:  0.2027 
F-statistic: 44.34 on 18 and 3051 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Gives better adjusted R squared fo sho.</p>
<p>Using leaps package</p>
<pre class="r"><code>models_leap &lt;- regsubsets(dAdt~., data = pancrea_holes_1[c(&#39;dAdt&#39;, predictors_1)], nvmax = 7,
                     method = &quot;seqrep&quot;)

summary_leap &lt;- summary(models_leap)
summary_leap</code></pre>
<pre><code>Subset selection object
Call: regsubsets.formula(dAdt ~ ., data = pancrea_holes_1[c(&quot;dAdt&quot;, 
    predictors_1)], nvmax = 7, method = &quot;seqrep&quot;)
6 Variables  (and intercept)
                 Forced in Forced out
numCon               FALSE      FALSE
numEnds              FALSE      FALSE
period               FALSE      FALSE
hole_area_smooth     FALSE      FALSE
eccentricity         FALSE      FALSE
solidity             FALSE      FALSE
1 subsets of each size up to 6
Selection Algorithm: &#39;sequential replacement&#39;
         numCon numEnds period hole_area_smooth eccentricity solidity
1  ( 1 ) &quot; &quot;    &quot;*&quot;     &quot; &quot;    &quot; &quot;              &quot; &quot;          &quot; &quot;     
2  ( 1 ) &quot;*&quot;    &quot; &quot;     &quot; &quot;    &quot;*&quot;              &quot; &quot;          &quot; &quot;     
3  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;    &quot; &quot;              &quot; &quot;          &quot; &quot;     
4  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot; &quot;    &quot;*&quot;              &quot; &quot;          &quot;*&quot;     
5  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot; &quot;    &quot;*&quot;              &quot;*&quot;          &quot;*&quot;     
6  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;    &quot;*&quot;              &quot;*&quot;          &quot;*&quot;     </code></pre>
<pre class="r"><code>summary_leap$bic</code></pre>
<pre><code>[1]  -36.07497 -117.79142  -56.77597 -178.50501 -181.36415 -174.81480</code></pre>
<p>Doing both forwards and backwards just because.</p>
<pre class="r"><code>models_forward &lt;- regsubsets(dAdt~., data = pancrea_holes_1[c(&#39;dAdt&#39;, predictors_1)], nvmax = 7,
                     method = &quot;forward&quot;)

summary_forward &lt;- summary(models_forward)
summary_forward</code></pre>
<pre><code>Subset selection object
Call: regsubsets.formula(dAdt ~ ., data = pancrea_holes_1[c(&quot;dAdt&quot;, 
    predictors_1)], nvmax = 7, method = &quot;forward&quot;)
6 Variables  (and intercept)
                 Forced in Forced out
numCon               FALSE      FALSE
numEnds              FALSE      FALSE
period               FALSE      FALSE
hole_area_smooth     FALSE      FALSE
eccentricity         FALSE      FALSE
solidity             FALSE      FALSE
1 subsets of each size up to 6
Selection Algorithm: forward
         numCon numEnds period hole_area_smooth eccentricity solidity
1  ( 1 ) &quot; &quot;    &quot;*&quot;     &quot; &quot;    &quot; &quot;              &quot; &quot;          &quot; &quot;     
2  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot; &quot;    &quot; &quot;              &quot; &quot;          &quot; &quot;     
3  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot; &quot;    &quot;*&quot;              &quot; &quot;          &quot; &quot;     
4  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot; &quot;    &quot;*&quot;              &quot; &quot;          &quot;*&quot;     
5  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot; &quot;    &quot;*&quot;              &quot;*&quot;          &quot;*&quot;     
6  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;    &quot;*&quot;              &quot;*&quot;          &quot;*&quot;     </code></pre>
<pre class="r"><code>summary_forward$bic</code></pre>
<pre><code>[1]  -36.07497  -64.65230 -141.25660 -178.50501 -181.36415 -174.81480</code></pre>
<pre class="r"><code>models_backward &lt;- regsubsets(dAdt~., data = pancrea_holes_1[c(&#39;dAdt&#39;, predictors_1)], nvmax = 7,
                     method = &quot;backward&quot;)

summary_backward &lt;- summary(models_backward)
summary_backward</code></pre>
<pre><code>Subset selection object
Call: regsubsets.formula(dAdt ~ ., data = pancrea_holes_1[c(&quot;dAdt&quot;, 
    predictors_1)], nvmax = 7, method = &quot;backward&quot;)
6 Variables  (and intercept)
                 Forced in Forced out
numCon               FALSE      FALSE
numEnds              FALSE      FALSE
period               FALSE      FALSE
hole_area_smooth     FALSE      FALSE
eccentricity         FALSE      FALSE
solidity             FALSE      FALSE
1 subsets of each size up to 6
Selection Algorithm: backward
         numCon numEnds period hole_area_smooth eccentricity solidity
1  ( 1 ) &quot;*&quot;    &quot; &quot;     &quot; &quot;    &quot; &quot;              &quot; &quot;          &quot; &quot;     
2  ( 1 ) &quot;*&quot;    &quot; &quot;     &quot; &quot;    &quot;*&quot;              &quot; &quot;          &quot; &quot;     
3  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot; &quot;    &quot;*&quot;              &quot; &quot;          &quot; &quot;     
4  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot; &quot;    &quot;*&quot;              &quot; &quot;          &quot;*&quot;     
5  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot; &quot;    &quot;*&quot;              &quot;*&quot;          &quot;*&quot;     
6  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;    &quot;*&quot;              &quot;*&quot;          &quot;*&quot;     </code></pre>
<pre class="r"><code>summary_backward$bic</code></pre>
<pre><code>[1]  -35.76123 -117.79142 -141.25660 -178.50501 -181.36415 -174.81480</code></pre>
<p>We can try higher order model, see wut happens.</p>
<pre class="r"><code>Nsquaredpermutations &lt;- function(n.features){ # since the regsubsets function has a max number of variables, we just put in the maximum number of possible variables of 2nd order
  return((n.features^2-n.features)/2 + n.features + 1)
}
models_leap_square &lt;- regsubsets(dAdt~.^2, data = pancrea_holes_1[c(&#39;dAdt&#39;, predictors_1)], nvmax = Nsquaredpermutations(length(predictors_1)),
                     method = &quot;seqrep&quot;)

summary_leap_square &lt;- summary(models_leap_square)
summary_leap_square</code></pre>
<pre><code>Subset selection object
Call: regsubsets.formula(dAdt ~ .^2, data = pancrea_holes_1[c(&quot;dAdt&quot;, 
    predictors_1)], nvmax = Nsquaredpermutations(length(predictors_1)), 
    method = &quot;seqrep&quot;)
21 Variables  (and intercept)
                              Forced in Forced out
numCon                            FALSE      FALSE
numEnds                           FALSE      FALSE
period                            FALSE      FALSE
hole_area_smooth                  FALSE      FALSE
eccentricity                      FALSE      FALSE
solidity                          FALSE      FALSE
numCon:numEnds                    FALSE      FALSE
numCon:period                     FALSE      FALSE
numCon:hole_area_smooth           FALSE      FALSE
numCon:eccentricity               FALSE      FALSE
numCon:solidity                   FALSE      FALSE
numEnds:period                    FALSE      FALSE
numEnds:hole_area_smooth          FALSE      FALSE
numEnds:eccentricity              FALSE      FALSE
numEnds:solidity                  FALSE      FALSE
period:hole_area_smooth           FALSE      FALSE
period:eccentricity               FALSE      FALSE
period:solidity                   FALSE      FALSE
hole_area_smooth:eccentricity     FALSE      FALSE
hole_area_smooth:solidity         FALSE      FALSE
eccentricity:solidity             FALSE      FALSE
1 subsets of each size up to 21
Selection Algorithm: &#39;sequential replacement&#39;
          numCon numEnds period hole_area_smooth eccentricity solidity
1  ( 1 )  &quot; &quot;    &quot; &quot;     &quot; &quot;    &quot; &quot;              &quot; &quot;          &quot; &quot;     
2  ( 1 )  &quot; &quot;    &quot; &quot;     &quot; &quot;    &quot;*&quot;              &quot; &quot;          &quot; &quot;     
3  ( 1 )  &quot; &quot;    &quot; &quot;     &quot; &quot;    &quot;*&quot;              &quot; &quot;          &quot; &quot;     
4  ( 1 )  &quot; &quot;    &quot; &quot;     &quot; &quot;    &quot;*&quot;              &quot; &quot;          &quot; &quot;     
5  ( 1 )  &quot; &quot;    &quot; &quot;     &quot; &quot;    &quot;*&quot;              &quot; &quot;          &quot; &quot;     
6  ( 1 )  &quot; &quot;    &quot; &quot;     &quot; &quot;    &quot;*&quot;              &quot; &quot;          &quot; &quot;     
7  ( 1 )  &quot; &quot;    &quot; &quot;     &quot; &quot;    &quot;*&quot;              &quot;*&quot;          &quot;*&quot;     
8  ( 1 )  &quot;*&quot;    &quot; &quot;     &quot; &quot;    &quot;*&quot;              &quot;*&quot;          &quot; &quot;     
9  ( 1 )  &quot;*&quot;    &quot; &quot;     &quot; &quot;    &quot;*&quot;              &quot;*&quot;          &quot; &quot;     
10  ( 1 ) &quot; &quot;    &quot; &quot;     &quot; &quot;    &quot;*&quot;              &quot; &quot;          &quot; &quot;     
11  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot; &quot;    &quot;*&quot;              &quot;*&quot;          &quot; &quot;     
12  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot; &quot;    &quot;*&quot;              &quot;*&quot;          &quot; &quot;     
13  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;    &quot;*&quot;              &quot;*&quot;          &quot;*&quot;     
14  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot; &quot;    &quot;*&quot;              &quot; &quot;          &quot;*&quot;     
15  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;    &quot;*&quot;              &quot; &quot;          &quot; &quot;     
16  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;    &quot;*&quot;              &quot;*&quot;          &quot;*&quot;     
17  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;    &quot;*&quot;              &quot;*&quot;          &quot;*&quot;     
18  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;    &quot;*&quot;              &quot;*&quot;          &quot;*&quot;     
19  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;    &quot;*&quot;              &quot;*&quot;          &quot;*&quot;     
20  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;    &quot;*&quot;              &quot;*&quot;          &quot;*&quot;     
21  ( 1 ) &quot;*&quot;    &quot;*&quot;     &quot;*&quot;    &quot;*&quot;              &quot;*&quot;          &quot;*&quot;     
          numCon:numEnds numCon:period numCon:hole_area_smooth
1  ( 1 )  &quot; &quot;            &quot; &quot;           &quot; &quot;                    
2  ( 1 )  &quot; &quot;            &quot; &quot;           &quot;*&quot;                    
3  ( 1 )  &quot; &quot;            &quot; &quot;           &quot;*&quot;                    
4  ( 1 )  &quot;*&quot;            &quot; &quot;           &quot;*&quot;                    
5  ( 1 )  &quot; &quot;            &quot; &quot;           &quot;*&quot;                    
6  ( 1 )  &quot; &quot;            &quot; &quot;           &quot;*&quot;                    
7  ( 1 )  &quot;*&quot;            &quot; &quot;           &quot;*&quot;                    
8  ( 1 )  &quot;*&quot;            &quot; &quot;           &quot;*&quot;                    
9  ( 1 )  &quot;*&quot;            &quot; &quot;           &quot;*&quot;                    
10  ( 1 ) &quot;*&quot;            &quot; &quot;           &quot;*&quot;                    
11  ( 1 ) &quot;*&quot;            &quot; &quot;           &quot;*&quot;                    
12  ( 1 ) &quot;*&quot;            &quot;*&quot;           &quot;*&quot;                    
13  ( 1 ) &quot;*&quot;            &quot;*&quot;           &quot;*&quot;                    
14  ( 1 ) &quot;*&quot;            &quot;*&quot;           &quot;*&quot;                    
15  ( 1 ) &quot;*&quot;            &quot;*&quot;           &quot;*&quot;                    
16  ( 1 ) &quot;*&quot;            &quot;*&quot;           &quot;*&quot;                    
17  ( 1 ) &quot;*&quot;            &quot;*&quot;           &quot;*&quot;                    
18  ( 1 ) &quot;*&quot;            &quot;*&quot;           &quot;*&quot;                    
19  ( 1 ) &quot;*&quot;            &quot;*&quot;           &quot;*&quot;                    
20  ( 1 ) &quot;*&quot;            &quot;*&quot;           &quot;*&quot;                    
21  ( 1 ) &quot;*&quot;            &quot;*&quot;           &quot;*&quot;                    
          numCon:eccentricity numCon:solidity numEnds:period
1  ( 1 )  &quot;*&quot;                 &quot; &quot;             &quot; &quot;           
2  ( 1 )  &quot; &quot;                 &quot; &quot;             &quot; &quot;           
3  ( 1 )  &quot; &quot;                 &quot; &quot;             &quot; &quot;           
4  ( 1 )  &quot; &quot;                 &quot; &quot;             &quot; &quot;           
5  ( 1 )  &quot; &quot;                 &quot; &quot;             &quot; &quot;           
6  ( 1 )  &quot; &quot;                 &quot; &quot;             &quot; &quot;           
7  ( 1 )  &quot; &quot;                 &quot; &quot;             &quot; &quot;           
8  ( 1 )  &quot; &quot;                 &quot;*&quot;             &quot; &quot;           
9  ( 1 )  &quot; &quot;                 &quot;*&quot;             &quot;*&quot;           
10  ( 1 ) &quot;*&quot;                 &quot;*&quot;             &quot;*&quot;           
11  ( 1 ) &quot;*&quot;                 &quot;*&quot;             &quot;*&quot;           
12  ( 1 ) &quot;*&quot;                 &quot;*&quot;             &quot; &quot;           
13  ( 1 ) &quot;*&quot;                 &quot;*&quot;             &quot;*&quot;           
14  ( 1 ) &quot;*&quot;                 &quot;*&quot;             &quot; &quot;           
15  ( 1 ) &quot;*&quot;                 &quot;*&quot;             &quot;*&quot;           
16  ( 1 ) &quot;*&quot;                 &quot;*&quot;             &quot;*&quot;           
17  ( 1 ) &quot;*&quot;                 &quot;*&quot;             &quot;*&quot;           
18  ( 1 ) &quot;*&quot;                 &quot;*&quot;             &quot;*&quot;           
19  ( 1 ) &quot;*&quot;                 &quot;*&quot;             &quot;*&quot;           
20  ( 1 ) &quot;*&quot;                 &quot;*&quot;             &quot;*&quot;           
21  ( 1 ) &quot;*&quot;                 &quot;*&quot;             &quot;*&quot;           
          numEnds:hole_area_smooth numEnds:eccentricity numEnds:solidity
1  ( 1 )  &quot; &quot;                      &quot; &quot;                  &quot; &quot;             
2  ( 1 )  &quot; &quot;                      &quot; &quot;                  &quot; &quot;             
3  ( 1 )  &quot; &quot;                      &quot;*&quot;                  &quot; &quot;             
4  ( 1 )  &quot; &quot;                      &quot; &quot;                  &quot; &quot;             
5  ( 1 )  &quot;*&quot;                      &quot; &quot;                  &quot; &quot;             
6  ( 1 )  &quot;*&quot;                      &quot; &quot;                  &quot; &quot;             
7  ( 1 )  &quot; &quot;                      &quot; &quot;                  &quot; &quot;             
8  ( 1 )  &quot; &quot;                      &quot; &quot;                  &quot; &quot;             
9  ( 1 )  &quot; &quot;                      &quot; &quot;                  &quot; &quot;             
10  ( 1 ) &quot; &quot;                      &quot; &quot;                  &quot; &quot;             
11  ( 1 ) &quot; &quot;                      &quot; &quot;                  &quot; &quot;             
12  ( 1 ) &quot; &quot;                      &quot; &quot;                  &quot; &quot;             
13  ( 1 ) &quot;*&quot;                      &quot; &quot;                  &quot; &quot;             
14  ( 1 ) &quot; &quot;                      &quot; &quot;                  &quot; &quot;             
15  ( 1 ) &quot; &quot;                      &quot; &quot;                  &quot; &quot;             
16  ( 1 ) &quot;*&quot;                      &quot;*&quot;                  &quot;*&quot;             
17  ( 1 ) &quot;*&quot;                      &quot;*&quot;                  &quot;*&quot;             
18  ( 1 ) &quot; &quot;                      &quot;*&quot;                  &quot; &quot;             
19  ( 1 ) &quot; &quot;                      &quot;*&quot;                  &quot; &quot;             
20  ( 1 ) &quot; &quot;                      &quot;*&quot;                  &quot;*&quot;             
21  ( 1 ) &quot;*&quot;                      &quot;*&quot;                  &quot;*&quot;             
          period:hole_area_smooth period:eccentricity period:solidity
1  ( 1 )  &quot; &quot;                     &quot; &quot;                 &quot; &quot;            
2  ( 1 )  &quot; &quot;                     &quot; &quot;                 &quot; &quot;            
3  ( 1 )  &quot; &quot;                     &quot; &quot;                 &quot; &quot;            
4  ( 1 )  &quot; &quot;                     &quot; &quot;                 &quot; &quot;            
5  ( 1 )  &quot; &quot;                     &quot; &quot;                 &quot; &quot;            
6  ( 1 )  &quot; &quot;                     &quot; &quot;                 &quot; &quot;            
7  ( 1 )  &quot; &quot;                     &quot; &quot;                 &quot; &quot;            
8  ( 1 )  &quot; &quot;                     &quot; &quot;                 &quot; &quot;            
9  ( 1 )  &quot; &quot;                     &quot; &quot;                 &quot; &quot;            
10  ( 1 ) &quot; &quot;                     &quot; &quot;                 &quot;*&quot;            
11  ( 1 ) &quot; &quot;                     &quot; &quot;                 &quot; &quot;            
12  ( 1 ) &quot; &quot;                     &quot; &quot;                 &quot;*&quot;            
13  ( 1 ) &quot; &quot;                     &quot; &quot;                 &quot; &quot;            
14  ( 1 ) &quot; &quot;                     &quot;*&quot;                 &quot;*&quot;            
15  ( 1 ) &quot; &quot;                     &quot;*&quot;                 &quot;*&quot;            
16  ( 1 ) &quot;*&quot;                     &quot; &quot;                 &quot; &quot;            
17  ( 1 ) &quot;*&quot;                     &quot;*&quot;                 &quot; &quot;            
18  ( 1 ) &quot; &quot;                     &quot;*&quot;                 &quot;*&quot;            
19  ( 1 ) &quot;*&quot;                     &quot;*&quot;                 &quot;*&quot;            
20  ( 1 ) &quot;*&quot;                     &quot;*&quot;                 &quot;*&quot;            
21  ( 1 ) &quot;*&quot;                     &quot;*&quot;                 &quot;*&quot;            
          hole_area_smooth:eccentricity hole_area_smooth:solidity
1  ( 1 )  &quot; &quot;                           &quot; &quot;                      
2  ( 1 )  &quot; &quot;                           &quot; &quot;                      
3  ( 1 )  &quot; &quot;                           &quot; &quot;                      
4  ( 1 )  &quot;*&quot;                           &quot; &quot;                      
5  ( 1 )  &quot;*&quot;                           &quot;*&quot;                      
6  ( 1 )  &quot;*&quot;                           &quot;*&quot;                      
7  ( 1 )  &quot;*&quot;                           &quot;*&quot;                      
8  ( 1 )  &quot;*&quot;                           &quot;*&quot;                      
9  ( 1 )  &quot;*&quot;                           &quot;*&quot;                      
10  ( 1 ) &quot;*&quot;                           &quot;*&quot;                      
11  ( 1 ) &quot;*&quot;                           &quot;*&quot;                      
12  ( 1 ) &quot;*&quot;                           &quot;*&quot;                      
13  ( 1 ) &quot; &quot;                           &quot; &quot;                      
14  ( 1 ) &quot;*&quot;                           &quot;*&quot;                      
15  ( 1 ) &quot;*&quot;                           &quot;*&quot;                      
16  ( 1 ) &quot; &quot;                           &quot; &quot;                      
17  ( 1 ) &quot; &quot;                           &quot; &quot;                      
18  ( 1 ) &quot;*&quot;                           &quot;*&quot;                      
19  ( 1 ) &quot;*&quot;                           &quot;*&quot;                      
20  ( 1 ) &quot;*&quot;                           &quot;*&quot;                      
21  ( 1 ) &quot;*&quot;                           &quot;*&quot;                      
          eccentricity:solidity
1  ( 1 )  &quot; &quot;                  
2  ( 1 )  &quot; &quot;                  
3  ( 1 )  &quot; &quot;                  
4  ( 1 )  &quot; &quot;                  
5  ( 1 )  &quot; &quot;                  
6  ( 1 )  &quot;*&quot;                  
7  ( 1 )  &quot; &quot;                  
8  ( 1 )  &quot; &quot;                  
9  ( 1 )  &quot; &quot;                  
10  ( 1 ) &quot;*&quot;                  
11  ( 1 ) &quot; &quot;                  
12  ( 1 ) &quot; &quot;                  
13  ( 1 ) &quot; &quot;                  
14  ( 1 ) &quot;*&quot;                  
15  ( 1 ) &quot;*&quot;                  
16  ( 1 ) &quot; &quot;                  
17  ( 1 ) &quot; &quot;                  
18  ( 1 ) &quot;*&quot;                  
19  ( 1 ) &quot;*&quot;                  
20  ( 1 ) &quot;*&quot;                  
21  ( 1 ) &quot;*&quot;                  </code></pre>
<pre class="r"><code>summary_leap_square$bic</code></pre>
<pre><code> [1]  -63.54805 -174.54963 -224.02449 -302.06565 -334.92085 -408.11345
 [7] -427.22907 -505.92208 -543.77321 -573.70956 -579.42099 -580.28656
[13] -310.60661 -580.22657 -577.98218 -290.76927 -283.17979 -560.79231
[19] -554.37669 -546.47464 -538.73503</code></pre>
<p>I.e. the interaction model with the lowest bic is</p>
<pre class="r"><code>which(summary_leap_square$bic==min(summary_leap_square$bic))</code></pre>
<pre><code>[1] 12</code></pre>
<p>We extract the variables of this model and put it into lm</p>
<pre class="r"><code>interaction_str &lt;- summary_leap_square$outmat[12, ][summary_leap_square$outmat[12, ]==&#39;*&#39;] %&gt;% names %&gt;% paste(., collapse=&#39;+&#39;) %&gt;% paste0(&#39;dAdt~&#39;,&#39;&#39;,.)
linmodel_interaction_leaps &lt;- lm(as.formula(interaction_str), data=pancrea_holes_1)</code></pre>
<pre class="r"><code>summary(linmodel_interaction_leaps)</code></pre>
<pre><code>
Call:
lm(formula = as.formula(interaction_str), data = pancrea_holes_1)

Residuals:
     Min       1Q   Median       3Q      Max 
-211.174  -18.369    2.351   18.954  174.924 

Coefficients:
                                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                   -2.245e+02  3.058e+01  -7.343 2.67e-13 ***
numCon                        -1.090e+02  1.578e+01  -6.909 5.93e-12 ***
numEnds                        2.507e+01  4.147e+00   6.044 1.68e-09 ***
hole_area_smooth               2.380e-01  1.338e-02  17.784  &lt; 2e-16 ***
eccentricity                   3.067e+02  2.980e+01  10.291  &lt; 2e-16 ***
numCon:numEnds                -8.939e+00  9.370e-01  -9.540  &lt; 2e-16 ***
numCon:period                  1.298e+00  2.413e-01   5.381 7.97e-08 ***
numCon:hole_area_smooth       -4.907e-03  3.926e-04 -12.498  &lt; 2e-16 ***
numCon:eccentricity           -4.422e+01  7.469e+00  -5.921 3.55e-09 ***
numCon:solidity                1.471e+02  1.162e+01  12.655  &lt; 2e-16 ***
period:solidity               -4.769e+00  9.869e-01  -4.832 1.42e-06 ***
hole_area_smooth:eccentricity -7.513e-02  4.814e-03 -15.606  &lt; 2e-16 ***
hole_area_smooth:solidity     -1.761e-01  1.105e-02 -15.932  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 37.67 on 3057 degrees of freedom
Multiple R-squared:  0.1999,    Adjusted R-squared:  0.1968 
F-statistic: 63.65 on 12 and 3057 DF,  p-value: &lt; 2.2e-16</code></pre>
<pre class="r"><code>AIC(linmodel_interaction_leaps)</code></pre>
<pre><code>[1] 31007.89</code></pre>
<pre class="r"><code>BIC(linmodel_interaction_leaps)</code></pre>
<pre><code>[1] 31092.3</code></pre>
<pre class="r"><code>plot(linmodel_interaction_leaps)</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-24-1.png" width="672" style="display: block; margin: auto;" /><img src="figure/compare_data.Rmd/unnamed-chunk-24-2.png" width="672" style="display: block; margin: auto;" /><img src="figure/compare_data.Rmd/unnamed-chunk-24-3.png" width="672" style="display: block; margin: auto;" /><img src="figure/compare_data.Rmd/unnamed-chunk-24-4.png" width="672" style="display: block; margin: auto;" /> Yeah, improved adjusted R squared fo sho.</p>
<p>Btw, which rows were removed by na.omit?</p>
<pre class="r"><code>removed_rows_bool &lt;- pancrea_holes_all[names(pancrea_holes_all)!=&#39;hole_area_raw&#39;] %&gt;% apply(1, function(row){
  return((row %&gt;% sapply(function(x){is.na(x)}) %&gt;% sum())&gt;0)
})
removed_rows &lt;- pancrea_holes_all[removed_rows_bool, ]
table(removed_rows$hole_num_rep)</code></pre>
<pre><code>
 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 
 1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1  1 20  1 11  1  1 
26 27 28 29 30 31 32 
 1  1  1  1  1  1  1 </code></pre>
<pre class="r"><code>table(pancrea_holes_all$hole_num_rep) # 21 and 23 are completely removed by the filtering due to NaNs in period</code></pre>
<pre><code>
  1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18 
 21  20  55  13 160  56  67 178  74  34  41  58 226 226 224 203  46  25 
 19  20  21  22  23  24  25  26  27  28  29  30  31  32 
226  45  20 171  11 121 161 156 131  60  19  90 121  72 </code></pre>
<p>Check similarity between me and siljas counts, using zero-one loss and squared loss.</p>
<pre class="r"><code>Zeroone &lt;- function(v1, v2){
  return(1-sum(v1==v2)/length(v1))
}

Squarederror &lt;- function(v1, v2){
  sq.loss &lt;- sum((v1-v2)^2)/length(v1)
  return(sq.loss)
}

Squarederror(split(pancrea_holes_1$numEnds, pancrea_holes_1$hole_num_rep)$`22`, split(pancrea_holes_2$numEnds, pancrea_holes_2$hole_num_rep)$`22`) # sanity check</code></pre>
<pre><code>[1] 0.2588235</code></pre>
<pre class="r"><code>CalcError &lt;- function(df1, df2, vectors.to.split, split.by=&#39;hole_num_rep&#39;){
  calcerrors &lt;- function(v1, v2){
    return(c(zeroone=Zeroone(v1, v2), squarederror=Squarederror(v1, v2)))
  }
  sub.dfs.by.factor &lt;- vectors.to.split %&gt;% lapply(function(vector.name){
    df1.split &lt;- df1[[vector.name]] %&gt;% split(df1[[split.by]])
    df2.split &lt;- df2[[vector.name]] %&gt;% split(df2[[split.by]])
    return(list(df1.split = df1.split, df2.split = df2.split))
  })
  sub.dfs.by.factor %&lt;&gt;% setNames(vectors.to.split)
  errors.by.factor &lt;- sub.dfs.by.factor %&gt;% lapply(function(data.list){
    errors.by.split &lt;- Map(calcerrors, data.list[[1]], data.list[[2]])
    return(errors.by.split)
  })
  errors.by.factor &lt;- errors.by.factor %&gt;% lapply(function(x){do.call(rbind,x)}) %&gt;% lapply(as.data.frame) %&gt;% lapply(tibble::rownames_to_column, var=&#39;hole&#39;)
  errors.df &lt;- dplyr::bind_rows(errors.by.factor, .id=&#39;compared_factor&#39;)
  average.errors &lt;- vectors.to.split %&gt;% sapply(function(vector.name){
    return(calcerrors(df1[[vector.name]], df2[[vector.name]]))
  })
  return(list(errors.df=errors.df, average.errors=average.errors))
}</code></pre>
<pre class="r"><code>error_pancrea &lt;- CalcError(pancrea_holes_1, pancrea_holes_2, c(&#39;numCon&#39;, &#39;numEnds&#39;))
error_pancrea$errors.df %&gt;% ggplot((aes(x=as.factor(as.numeric(hole)), y=zeroone, col=compared_factor)))+
  theme(axis.text.x = element_text(angle = -90, hjust = 1))+geom_jitter()</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-27-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>error_pancrea$errors.df %&gt;% ggplot((aes(x=as.factor(as.numeric(hole)), y=squarederror, col=compared_factor)))+
  theme(axis.text.x = element_text(angle = -90, hjust = 1))+geom_jitter()</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-27-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>quick plot of fitted vs real values for the various models</p>
<pre class="r"><code>plot(linmodel_1$fitted.values~pancrea_holes_1$dAdt)</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-28-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(step_mass_squared_bi$fitted.values~pancrea_holes_1$dAdt)</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-28-2.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>plot(linmodel_interaction_leaps$fitted.values~pancrea_holes_1$dAdt)</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-28-3.png" width="672" style="display: block; margin: auto;" /></p>
<p>Let’s also just check the correlations</p>
<pre class="r"><code>cor(linmodel_1$fitted.values, pancrea_holes_1$dAdt)</code></pre>
<pre><code>[1] 0.2692386</code></pre>
<pre class="r"><code>cor(step_mass_squared_bi$fitted.values, pancrea_holes_1$dAdt)</code></pre>
<pre><code>[1] 0.455347</code></pre>
<pre class="r"><code>cor(linmodel_interaction_leaps$fitted.values, pancrea_holes_1$dAdt)</code></pre>
<pre><code>[1] 0.4471024</code></pre>
<p>We can also try to down sample to circumvent IID assumption violation</p>
<pre class="r"><code>Sampleintervals &lt;- function(df, interval.length, offset=0){
  start.from &lt;- 1+offset
  n &lt;- nrow(df)
  if(start.from&gt;=n || interval.length &gt;=n){
    indices &lt;- sample(n, 1)
  } else {
    indices &lt;- seq(start.from, n, interval.length)
  }
  return(df[indices, ])
}

Makedownsampled &lt;- function(df, interval.length, split.by=&#39;hole_num_rep&#39;, offset=0){
  sub.dfs &lt;- df %&gt;% split(df[[split.by]])
  downsampled.dfs &lt;- sub.dfs %&gt;% lapply(function(x){return(Sampleintervals(x, interval.length=interval.length, offset=offset))})
  downsampled.rbound &lt;- dplyr::bind_rows(downsampled.dfs)
  return(downsampled.rbound)
}

downsampled_df &lt;- Makedownsampled(pancrea_holes_1, 5, &#39;hole_num_rep&#39;)
linmodel_downsampled &lt;- lm(dAdt~numCon + numEnds + period + hole_area_smooth + eccentricity + solidity, data = downsampled_df)</code></pre>
<pre class="r"><code>plot(linmodel_downsampled)</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-31-1.png" width="672" style="display: block; margin: auto;" /><img src="figure/compare_data.Rmd/unnamed-chunk-31-2.png" width="672" style="display: block; margin: auto;" /><img src="figure/compare_data.Rmd/unnamed-chunk-31-3.png" width="672" style="display: block; margin: auto;" /><img src="figure/compare_data.Rmd/unnamed-chunk-31-4.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>summary(linmodel_downsampled)</code></pre>
<pre><code>
Call:
lm(formula = dAdt ~ numCon + numEnds + period + hole_area_smooth + 
    eccentricity + solidity, data = downsampled_df)

Residuals:
     Min       1Q   Median       3Q      Max 
-209.518  -18.620    2.285   20.124  164.512 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      -5.874e+01  5.522e+01  -1.064 0.287865    
numCon           -5.772e+00  1.651e+00  -3.497 0.000505 ***
numEnds          -6.455e+00  1.800e+00  -3.585 0.000364 ***
period            2.195e-01  3.827e-01   0.574 0.566391    
hole_area_smooth  4.172e-03  9.448e-04   4.415 1.19e-05 ***
eccentricity     -2.612e+01  1.734e+01  -1.506 0.132506    
solidity          8.891e+01  5.073e+01   1.753 0.080172 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 40.23 on 614 degrees of freedom
Multiple R-squared:  0.07018,   Adjusted R-squared:  0.06109 
F-statistic: 7.724 on 6 and 614 DF,  p-value: 5.08e-08</code></pre>
<p>Things look less fucked, but we have less statistical power now. Quickly check pred vs true plot and correlation. The results are less nighmarish looking but clearly linear model is insufficient.</p>
<pre class="r"><code>plot(linmodel_downsampled$fitted.values~downsampled_df$dAdt)</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-33-1.png" width="672" style="display: block; margin: auto;" /></p>
<pre class="r"><code>cor(linmodel_downsampled$fitted.values, downsampled_df$dAdt)</code></pre>
<pre><code>[1] 0.2649125</code></pre>
<p>We can try different offsets during the sampling (sampling 1 random point from the hole if offset &gt;= n_hole)</p>
<pre class="r"><code>offsets_ &lt;- c(0, 5, 10, 20, 30, 50)
dfs_offsets &lt;- offsets_ %&gt;% lapply(function(x, interval.length=20){
  df.downsampled &lt;- Makedownsampled(pancrea_holes_1, interval.length, offset=x)
  return(df.downsampled)
})

linmodels_offsets &lt;- dfs_offsets %&gt;% lapply(function(x){
  lm.downsampled &lt;- lm(dAdt~numCon + numEnds + period + hole_area_smooth + eccentricity + solidity, data = x)
  return(lm.downsampled)
})</code></pre>
<pre class="r"><code>offset_residplots &lt;- linmodels_offsets %&gt;% lapply(function(x){
  return(plot(x, which=c(1,1)))
})</code></pre>
<p><img src="figure/compare_data.Rmd/unnamed-chunk-35-1.png" width="672" style="display: block; margin: auto;" /><img src="figure/compare_data.Rmd/unnamed-chunk-35-2.png" width="672" style="display: block; margin: auto;" /><img src="figure/compare_data.Rmd/unnamed-chunk-35-3.png" width="672" style="display: block; margin: auto;" /><img src="figure/compare_data.Rmd/unnamed-chunk-35-4.png" width="672" style="display: block; margin: auto;" /><img src="figure/compare_data.Rmd/unnamed-chunk-35-5.png" width="672" style="display: block; margin: auto;" /><img src="figure/compare_data.Rmd/unnamed-chunk-35-6.png" width="672" style="display: block; margin: auto;" /></p>
<p>summaries of the models</p>
<pre class="r"><code>linmodels_offsets %&gt;% lapply(summary)</code></pre>
<pre><code>[[1]]

Call:
lm(formula = dAdt ~ numCon + numEnds + period + hole_area_smooth + 
    eccentricity + solidity, data = x)

Residuals:
     Min       1Q   Median       3Q      Max 
-195.270  -22.183    1.649   19.861  162.796 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)      -90.932126 108.098333  -0.841   0.4015  
numCon            -5.540483   3.361793  -1.648   0.1013  
numEnds           -6.427740   3.680218  -1.747   0.0827 .
period             0.584798   0.771029   0.758   0.4493  
hole_area_smooth   0.003776   0.001892   1.996   0.0477 *
eccentricity     -13.593303  32.815545  -0.414   0.6793  
solidity         106.316779  99.522407   1.068   0.2870  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 42.16 on 158 degrees of freedom
Multiple R-squared:  0.05984,   Adjusted R-squared:  0.02414 
F-statistic: 1.676 on 6 and 158 DF,  p-value: 0.1301


[[2]]

Call:
lm(formula = dAdt ~ numCon + numEnds + period + hole_area_smooth + 
    eccentricity + solidity, data = x)

Residuals:
     Min       1Q   Median       3Q      Max 
-200.164  -18.242    4.274   19.387  157.314 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)      -62.802756 113.489165  -0.553   0.5808  
numCon            -5.254627   3.438982  -1.528   0.1286  
numEnds           -7.207884   3.696919  -1.950   0.0531 .
period             0.143863   0.777754   0.185   0.8535  
hole_area_smooth   0.004343   0.001968   2.207   0.0288 *
eccentricity     -15.161384  35.997673  -0.421   0.6742  
solidity          83.901839 103.977441   0.807   0.4210  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 41.56 on 150 degrees of freedom
Multiple R-squared:  0.06591,   Adjusted R-squared:  0.02855 
F-statistic: 1.764 on 6 and 150 DF,  p-value: 0.1102


[[3]]

Call:
lm(formula = dAdt ~ numCon + numEnds + period + hole_area_smooth + 
    eccentricity + solidity, data = x)

Residuals:
     Min       1Q   Median       3Q      Max 
-209.591  -17.245    4.481   23.532  117.249 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)      -49.055532 116.705140  -0.420   0.6749  
numCon            -5.861485   3.435513  -1.706   0.0901 .
numEnds           -6.900645   3.712004  -1.859   0.0650 .
period            -0.189559   0.775461  -0.244   0.8072  
hole_area_smooth   0.004744   0.001994   2.380   0.0186 *
eccentricity     -30.775003  37.341085  -0.824   0.4112  
solidity          91.384664 106.776636   0.856   0.3935  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 41.39 on 146 degrees of freedom
Multiple R-squared:  0.08217,   Adjusted R-squared:  0.04445 
F-statistic: 2.178 on 6 and 146 DF,  p-value: 0.04827


[[4]]

Call:
lm(formula = dAdt ~ numCon + numEnds + period + hole_area_smooth + 
    eccentricity + solidity, data = x)

Residuals:
     Min       1Q   Median       3Q      Max 
-188.287  -22.471    0.868   21.522  156.187 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)      -52.115533 133.680267  -0.390   0.6973  
numCon            -6.010118   3.586520  -1.676   0.0962 .
numEnds           -7.623049   4.074120  -1.871   0.0635 .
period             0.784561   0.865185   0.907   0.3662  
hole_area_smooth   0.003699   0.002089   1.771   0.0789 .
eccentricity     -64.276361  44.146099  -1.456   0.1478  
solidity         104.513321 120.720899   0.866   0.3882  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 42.43 on 132 degrees of freedom
Multiple R-squared:  0.08692,   Adjusted R-squared:  0.04541 
F-statistic: 2.094 on 6 and 132 DF,  p-value: 0.05802


[[5]]

Call:
lm(formula = dAdt ~ numCon + numEnds + period + hole_area_smooth + 
    eccentricity + solidity, data = x)

Residuals:
     Min       1Q   Median       3Q      Max 
-205.097  -16.333    3.551   22.982  120.209 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)      -66.296600 138.709979  -0.478   0.6335  
numCon            -5.189165   3.731084  -1.391   0.1668  
numEnds           -7.252381   4.233679  -1.713   0.0893 .
period            -0.619042   0.894353  -0.692   0.4902  
hole_area_smooth   0.004042   0.002229   1.813   0.0723 .
eccentricity     -24.018157  46.593588  -0.515   0.6072  
solidity         113.678419 126.253800   0.900   0.3697  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 42.48 on 121 degrees of freedom
Multiple R-squared:  0.07717,   Adjusted R-squared:  0.03141 
F-statistic: 1.686 on 6 and 121 DF,  p-value: 0.13


[[6]]

Call:
lm(formula = dAdt ~ numCon + numEnds + period + hole_area_smooth + 
    eccentricity + solidity, data = x)

Residuals:
     Min       1Q   Median       3Q      Max 
-195.112  -14.312    1.228   20.540  106.958 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)      -1.151e+02  1.498e+02  -0.769    0.444
numCon           -5.950e+00  3.987e+00  -1.492    0.139
numEnds          -6.207e+00  4.696e+00  -1.322    0.189
period           -3.459e-01  1.013e+00  -0.342    0.733
hole_area_smooth  2.918e-03  2.397e-03   1.218    0.226
eccentricity      1.056e+01  4.919e+01   0.215    0.830
solidity          1.323e+02  1.382e+02   0.957    0.341

Residual standard error: 42.49 on 100 degrees of freedom
Multiple R-squared:  0.06367,   Adjusted R-squared:  0.007489 
F-statistic: 1.133 on 6 and 100 DF,  p-value: 0.3486</code></pre>
<p>(remember that permutation matrix cancels out in formula to linear regression)</p>
<pre class="r"><code>quicktest &lt;- lm(dAdt~numCon + numEnds + period + hole_area_smooth + eccentricity + solidity, data = pancrea_holes_1[sample(1:nrow(pancrea_holes_1)), ])</code></pre>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 3.6.1 (2019-07-05)
Platform: x86_64-apple-darwin15.6.0 (64-bit)
Running under: macOS High Sierra 10.13.6

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/3.6/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] leaps_3.1       MASS_7.3-51.5   cowplot_1.0.0   magrittr_1.5   
 [5] irlba_2.3.3     Matrix_1.2-17   forcats_0.4.0   stringr_1.4.0  
 [9] dplyr_0.8.3     purrr_0.3.3     readr_1.3.1     tidyr_1.0.0    
[13] tibble_2.1.3    ggplot2_3.2.1   tidyverse_1.3.0

loaded via a namespace (and not attached):
 [1] Rcpp_1.0.2       lubridate_1.7.4  lattice_0.20-38  assertthat_0.2.1
 [5] rprojroot_1.3-2  digest_0.6.21    R6_2.4.0         cellranger_1.1.0
 [9] plyr_1.8.4       backports_1.1.4  reprex_0.3.0     evaluate_0.14   
[13] httr_1.4.1       pillar_1.4.2     rlang_0.4.4      lazyeval_0.2.2  
[17] readxl_1.3.1     rstudioapi_0.10  whisker_0.4      rmarkdown_1.15  
[21] labeling_0.3     munsell_0.5.0    broom_0.5.2      compiler_3.6.1  
[25] httpuv_1.5.2     modelr_0.1.5     xfun_0.9         pkgconfig_2.0.3 
[29] htmltools_0.3.6  tidyselect_0.2.5 workflowr_1.6.0  crayon_1.3.4    
[33] dbplyr_1.4.2     withr_2.1.2      later_0.8.0      grid_3.6.1      
[37] nlme_3.1-141     jsonlite_1.6     gtable_0.3.0     lifecycle_0.1.0 
[41] DBI_1.0.0        git2r_0.26.1     scales_1.0.0     cli_1.1.0       
[45] stringi_1.4.3    reshape2_1.4.3   fs_1.3.1         promises_1.0.1  
[49] xml2_1.2.2       generics_0.0.2   vctrs_0.2.2      tools_3.6.1     
[53] glue_1.3.1       hms_0.5.3        yaml_2.2.0       colorspace_1.4-1
[57] rvest_0.3.5      knitr_1.25       haven_2.2.0     </code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
